#pragma once

#include <map>

namespace Service::Internals
{
	class KeyNameHelper
	{
	public:
		inline int GetCode(std::string_view name) const;
		inline std::string_view GetName(int code) const;

		inline static KeyNameHelper& GetInstance();

	private:
		struct Key
		{
			const char* const name;
			const int code;

			inline Key(const char* name, int code) : name{ name }, code{ code } {};
			Key(const Key&) = delete;
			Key& operator=(const Key&) = delete;
		};
		
		inline KeyNameHelper();
		KeyNameHelper(const KeyNameHelper&) = delete;
		KeyNameHelper& operator=(const KeyNameHelper&) = delete;

		std::array<Key, 220> nameSortedKeys;
		std::array<int, 204> codeSortedIndexes;
	};
}

#pragma region Implementation

namespace Service::Internals
{
	int KeyNameHelper::GetCode(std::string_view name) const
	{
		const auto it = std::lower_bound(begin(nameSortedKeys), end(nameSortedKeys), name, [](const Key& key, std::string_view name)
		{
			return key.name < name;
		});

		return it == end(nameSortedKeys) ? 0 : it->code;
	}

	std::string_view KeyNameHelper::GetName(int code) const
	{
		const auto it = std::lower_bound(begin(codeSortedIndexes), end(codeSortedIndexes), code, [this](int index, int code)
		{
			return nameSortedKeys[index].code < code;
		});

		return it == end(codeSortedIndexes) ? std::string_view{} : nameSortedKeys[*it].name;
	}

	KeyNameHelper::KeyNameHelper() :
		nameSortedKeys
		{
			Key{ "JOY_BUTTON_1", 544 },
			Key{ "JOY_BUTTON_10", 553 },
			Key{ "JOY_BUTTON_11", 554 },
			Key{ "JOY_BUTTON_12", 555 },
			Key{ "JOY_BUTTON_13", 556 },
			Key{ "JOY_BUTTON_14", 557 },
			Key{ "JOY_BUTTON_15", 558 },
			Key{ "JOY_BUTTON_16", 559 },
			Key{ "JOY_BUTTON_17", 560 },
			Key{ "JOY_BUTTON_18", 561 },
			Key{ "JOY_BUTTON_19", 562 },
			Key{ "JOY_BUTTON_2", 545 },
			Key{ "JOY_BUTTON_20", 563 },
			Key{ "JOY_BUTTON_21", 564 },
			Key{ "JOY_BUTTON_22", 565 },
			Key{ "JOY_BUTTON_23", 566 },
			Key{ "JOY_BUTTON_24", 567 },
			Key{ "JOY_BUTTON_25", 568 },
			Key{ "JOY_BUTTON_26", 569 },
			Key{ "JOY_BUTTON_27", 570 },
			Key{ "JOY_BUTTON_28", 571 },
			Key{ "JOY_BUTTON_29", 572 },
			Key{ "JOY_BUTTON_3", 546 },
			Key{ "JOY_BUTTON_30", 573 },
			Key{ "JOY_BUTTON_31", 574 },
			Key{ "JOY_BUTTON_32", 575 },
			Key{ "JOY_BUTTON_4", 547 },
			Key{ "JOY_BUTTON_5", 548 },
			Key{ "JOY_BUTTON_6", 549 },
			Key{ "JOY_BUTTON_7", 550 },
			Key{ "JOY_BUTTON_8", 551 },
			Key{ "JOY_BUTTON_9", 552 },
			Key{ "JOY_DOWN", 535 },
			Key{ "JOY_LEFT", 532 },
			Key{ "JOY_POV_DOWN", 543 },
			Key{ "JOY_POV_LEFT", 540 },
			Key{ "JOY_POV_RIGHT", 541 },
			Key{ "JOY_POV_UP", 542 },
			Key{ "JOY_RIGHT", 533 },
			Key{ "JOY_UP", 534 },
			Key{ "KEY_0", 11 },
			Key{ "KEY_1", 2 },
			Key{ "KEY_2", 3 },
			Key{ "KEY_3", 4 },
			Key{ "KEY_4", 5 },
			Key{ "KEY_5", 6 },
			Key{ "KEY_6", 7 },
			Key{ "KEY_7", 8 },
			Key{ "KEY_8", 9 },
			Key{ "KEY_9", 10 },
			Key{ "KEY_A", 30 },
			Key{ "KEY_ABNT_C1", 115 },
			Key{ "KEY_ABNT_C2", 126 },
			Key{ "KEY_ADD", 78 },
			Key{ "KEY_APOSTROPHE", 40 },
			Key{ "KEY_APPS", 221 },
			Key{ "KEY_AT", 145 },
			Key{ "KEY_AX", 150 },
			Key{ "KEY_B", 48 },
			Key{ "KEY_BACK", 14 },
			Key{ "KEY_BACKSLASH", 43 },
			Key{ "KEY_BACKSPACE", 14 },
			Key{ "KEY_C", 46 },
			Key{ "KEY_CALCULATOR", 161 },
			Key{ "KEY_CAPITAL", 58 },
			Key{ "KEY_CAPSLOCK", 58 },
			Key{ "KEY_CIRCUMFLEX", 144 },
			Key{ "KEY_COLON", 146 },
			Key{ "KEY_COMMA", 51 },
			Key{ "KEY_CONVERT", 121 },
			Key{ "KEY_D", 32 },
			Key{ "KEY_DECIMAL", 83 },
			Key{ "KEY_DELETE", 211 },
			Key{ "KEY_DIVIDE", 181 },
			Key{ "KEY_DOWN", 208 },
			Key{ "KEY_DOWNARROW", 208 },
			Key{ "KEY_E", 18 },
			Key{ "KEY_END", 207 },
			Key{ "KEY_EQUALS", 13 },
			Key{ "KEY_ESCAPE", 1 },
			Key{ "KEY_F", 33 },
			Key{ "KEY_F1", 59 },
			Key{ "KEY_F10", 68 },
			Key{ "KEY_F11", 87 },
			Key{ "KEY_F12", 88 },
			Key{ "KEY_F13", 100 },
			Key{ "KEY_F14", 101 },
			Key{ "KEY_F15", 102 },
			Key{ "KEY_F2", 60 },
			Key{ "KEY_F3", 61 },
			Key{ "KEY_F4", 62 },
			Key{ "KEY_F5", 63 },
			Key{ "KEY_F6", 64 },
			Key{ "KEY_F7", 65 },
			Key{ "KEY_F8", 66 },
			Key{ "KEY_F9", 67 },
			Key{ "KEY_G", 34 },
			Key{ "KEY_GRAVE", 41 },
			Key{ "KEY_H", 35 },
			Key{ "KEY_HOME", 199 },
			Key{ "KEY_I", 23 },
			Key{ "KEY_INSERT", 210 },
			Key{ "KEY_J", 36 },
			Key{ "KEY_K", 37 },
			Key{ "KEY_KANA", 112 },
			Key{ "KEY_KANJI", 148 },
			Key{ "KEY_L", 38 },
			Key{ "KEY_LALT", 56 },
			Key{ "KEY_LBRACKET", 26 },
			Key{ "KEY_LCONTROL", 29 },
			Key{ "KEY_LEFT", 203 },
			Key{ "KEY_LEFTARROW", 203 },
			Key{ "KEY_LMENU", 56 },
			Key{ "KEY_LSHIFT", 42 },
			Key{ "KEY_LWIN", 219 },
			Key{ "KEY_M", 50 },
			Key{ "KEY_MAIL", 236 },
			Key{ "KEY_MEDIASELECT", 237 },
			Key{ "KEY_MEDIASTOP", 164 },
			Key{ "KEY_MINUS", 12 },
			Key{ "KEY_MULTIPLY", 55 },
			Key{ "KEY_MUTE", 160 },
			Key{ "KEY_MYCOMPUTER", 235 },
			Key{ "KEY_N", 49 },
			Key{ "KEY_NEXT", 209 },
			Key{ "KEY_NEXTTRACK", 153 },
			Key{ "KEY_NOCONVERT", 123 },
			Key{ "KEY_NUMLOCK", 69 },
			Key{ "KEY_NUMPAD0", 82 },
			Key{ "KEY_NUMPAD1", 79 },
			Key{ "KEY_NUMPAD2", 80 },
			Key{ "KEY_NUMPAD3", 81 },
			Key{ "KEY_NUMPAD4", 75 },
			Key{ "KEY_NUMPAD5", 76 },
			Key{ "KEY_NUMPAD6", 77 },
			Key{ "KEY_NUMPAD7", 71 },
			Key{ "KEY_NUMPAD8", 72 },
			Key{ "KEY_NUMPAD9", 73 },
			Key{ "KEY_NUMPADCOMMA", 179 },
			Key{ "KEY_NUMPADENTER", 156 },
			Key{ "KEY_NUMPADEQUALS", 141 },
			Key{ "KEY_NUMPADMINUS", 74 },
			Key{ "KEY_NUMPADPERIOD", 83 },
			Key{ "KEY_NUMPADPLUS", 78 },
			Key{ "KEY_NUMPADSLASH", 181 },
			Key{ "KEY_NUMPADSTAR", 55 },
			Key{ "KEY_O", 24 },
			Key{ "KEY_OEM_102", 86 },
			Key{ "KEY_P", 25 },
			Key{ "KEY_PAUSE", 197 },
			Key{ "KEY_PERIOD", 52 },
			Key{ "KEY_PGDN", 209 },
			Key{ "KEY_PGUP", 201 },
			Key{ "KEY_PLAYPAUSE", 162 },
			Key{ "KEY_POWER", 222 },
			Key{ "KEY_PREVTRACK", 144 },
			Key{ "KEY_PRIOR", 201 },
			Key{ "KEY_Q", 16 },
			Key{ "KEY_R", 19 },
			Key{ "KEY_RALT", 184 },
			Key{ "KEY_RBRACKET", 27 },
			Key{ "KEY_RCONTROL", 157 },
			Key{ "KEY_RETURN", 28 },
			Key{ "KEY_RIGHT", 205 },
			Key{ "KEY_RIGHTARROW", 205 },
			Key{ "KEY_RMENU", 184 },
			Key{ "KEY_RSHIFT", 54 },
			Key{ "KEY_RWIN", 220 },
			Key{ "KEY_S", 31 },
			Key{ "KEY_SCROLL", 70 },
			Key{ "KEY_SEMICOLON", 39 },
			Key{ "KEY_SLASH", 53 },
			Key{ "KEY_SLEEP", 223 },
			Key{ "KEY_SPACE", 57 },
			Key{ "KEY_STOP", 149 },
			Key{ "KEY_SUBTRACT", 74 },
			Key{ "KEY_SYSRQ", 183 },
			Key{ "KEY_T", 20 },
			Key{ "KEY_TAB", 15 },
			Key{ "KEY_U", 22 },
			Key{ "KEY_UNDERLINE", 147 },
			Key{ "KEY_UNLABELED", 151 },
			Key{ "KEY_UP", 200 },
			Key{ "KEY_UPARROW", 200 },
			Key{ "KEY_V", 47 },
			Key{ "KEY_VOLUMEDOWN", 174 },
			Key{ "KEY_VOLUMEUP", 176 },
			Key{ "KEY_W", 17 },
			Key{ "KEY_WAKE", 227 },
			Key{ "KEY_WEBBACK", 234 },
			Key{ "KEY_WEBFAVORITES", 230 },
			Key{ "KEY_WEBFORWARD", 233 },
			Key{ "KEY_WEBHOME", 178 },
			Key{ "KEY_WEBREFRESH", 231 },
			Key{ "KEY_WEBSEARCH", 229 },
			Key{ "KEY_WEBSTOP", 232 },
			Key{ "KEY_X", 45 },
			Key{ "KEY_Y", 21 },
			Key{ "KEY_YEN", 125 },
			Key{ "KEY_Z", 44 },
			Key{ "MOUSE_BUTTONLEFT", 524 },
			Key{ "MOUSE_BUTTONMID", 526 },
			Key{ "MOUSE_BUTTONRIGHT", 525 },
			Key{ "MOUSE_DOWN", 519 },
			Key{ "MOUSE_DX", 516 },
			Key{ "MOUSE_DY", 517 },
			Key{ "MOUSE_LEFT", 520 },
			Key{ "MOUSE_RIGHT", 521 },
			Key{ "MOUSE_UP", 518 },
			Key{ "MOUSE_WHEELDOWN", 523 },
			Key{ "MOUSE_WHEELUP", 522 },
			Key{ "MOUSE_XBUTTON1", 527 },
			Key{ "MOUSE_XBUTTON2", 528 },
			Key{ "MOUSE_XBUTTON3", 529 },
			Key{ "MOUSE_XBUTTON4", 530 },
			Key{ "MOUSE_XBUTTON5", 531 },
			Key{ "RUDDER_LEFT", 538 },
			Key{ "RUDDER_RIGHT", 539 },
			Key{ "THROTTLE_DOWN", 537 },
			Key{ "THROTTLE_UP", 536 }
		},
		codeSortedIndexes
		{
			79,
			41,
			42,
			43,
			44,
			45,
			46,
			47,
			48,
			49,
			40,
			119,
			78,
			59,
			178,
			157,
			187,
			76,
			158,
			177,
			197,
			179,
			100,
			146,
			148,
			108,
			160,
			162,
			109,
			50,
			168,
			70,
			80,
			96,
			98,
			102,
			103,
			106,
			170,
			54,
			97,
			113,
			60,
			199,
			196,
			62,
			184,
			58,
			123,
			115,
			68,
			150,
			171,
			166,
			120,
			112,
			173,
			64,
			81,
			88,
			89,
			90,
			91,
			92,
			93,
			94,
			95,
			82,
			127,
			169,
			135,
			136,
			137,
			175,
			132,
			133,
			134,
			53,
			129,
			130,
			131,
			128,
			71,
			147,
			83,
			84,
			85,
			86,
			87,
			104,
			51,
			69,
			126,
			198,
			52,
			140,
			155,
			56,
			67,
			180,
			105,
			174,
			57,
			181,
			125,
			139,
			161,
			121,
			63,
			153,
			118,
			185,
			186,
			192,
			138,
			73,
			176,
			165,
			149,
			99,
			182,
			156,
			110,
			163,
			77,
			74,
			124,
			101,
			72,
			114,
			167,
			55,
			154,
			172,
			188,
			194,
			190,
			193,
			195,
			191,
			189,
			122,
			116,
			117,
			204,
			205,
			208,
			203,
			206,
			207,
			210,
			209,
			200,
			202,
			201,
			211,
			212,
			213,
			214,
			215,
			33,
			38,
			39,
			32,
			219,
			218,
			216,
			217,
			35,
			36,
			37,
			34,
			0,
			11,
			22,
			26,
			27,
			28,
			29,
			30,
			31,
			1,
			2,
			3,
			4,
			5,
			6,
			7,
			8,
			9,
			10,
			12,
			13,
			14,
			15,
			16,
			17,
			18,
			19,
			20,
			21,
			23,
			24,
			25
		}
	{

	}

	KeyNameHelper& KeyNameHelper::GetInstance()
	{
		static std::unique_ptr<KeyNameHelper> keyNameHelper{ new KeyNameHelper() };
		return *keyNameHelper;
	}
}

#pragma endregion
